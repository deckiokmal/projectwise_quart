{% extends "base.html" %}
{% block title %}Chat • ProjectWise{% endblock %}

{% block head %}
{# Tambahkan head khusus halaman ini jika perlu #}
{% endblock %}

{% block body %}
<section class="chat">
  <!-- Header kecil halaman chat (opsional, bisa di-hide via CSS) -->
  <header class="chat__header" aria-label="Chat Header">
    <div class="chat__title">
      <i class="fa-solid fa-robot"></i>
      ProjectWise Assistant
    </div>
    <div class="chat__meta">
      <span class="status-dot status-dot--online"></span>
      <span class="chat__meta-text">Online</span>
    </div>
  </header>

  <!-- Area pesan (scrollable) -->
  <section id="chat-scroll" class="chat__messages" aria-live="polite" aria-label="Messages">
    <!-- Empty state (akan disembunyikan saat ada pesan) -->
    <div id="empty-state" class="empty-state">
      <div class="empty-state__icon">
        <i class="fa-solid fa-sparkles"></i>
      </div>
      <h2 class="empty-state__title">Mulai percakapan</h2>
      <p class="empty-state__desc">
        Tanyakan apa saja tentang tender, proposal, pricing, atau automasi jaringan.
      </p>
      <div class="empty-state__chips">
        <button class="chip" data-chip="analisis_kak">Analisis KAK/TOR</button>
        <button class="chip" data-chip="hitung_harga">Hitung Harga</button>
        <button class="chip" data-chip="rencana_eksekusi">Rencana Eksekusi</button>
        <button class="chip" data-chip="buat_proposal">Buat Proposal</button>
      </div>
    </div>

    <!-- Typing indicator -->
    <div id="typing" class="typing hidden" aria-hidden="true" aria-label="Assistant is typing">
      <span class="dot"></span><span class="dot"></span><span class="dot"></span>
    </div>
  </section>

  <!-- Input bar (horizontal) -->
  <footer class="chat__input main__input" aria-label="Chat Input">
    <form id="chat-form" class="input-bar" autocomplete="off">
      <!-- Tombol “+” + drop-up -->
      <div class="upload-dropdown">
        <button type="button" id="upload-btn" class="btn btn--icon" title="Upload" aria-haspopup="true"
          aria-expanded="false">
          <i class="fa-solid fa-plus"></i>
        </button>
        <div id="upload-menu" class="upload-menu hidden" role="menu" aria-label="Upload Menu">
          <button type="button" data-type="kak" class="upload-menu__item" role="menuitem">
            <i class="fa-regular fa-file-lines"></i> Upload KAK
          </button>
          <button type="button" data-type="product" class="upload-menu__item" role="menuitem">
            <i class="fa-solid fa-box"></i> Upload Product
          </button>
        </div>
      </div>

      <!-- Textarea fleksibel -->
      <textarea id="chat-input" name="message" placeholder="Tanya apa saja…" autocomplete="off" required rows="1"
        class="chat-textarea" aria-label="Message input"></textarea>

      <!-- Kirim -->
      <button type="submit" class="btn btn--send" title="Kirim">
        <i class="fa-solid fa-paper-plane"></i>
      </button>

      <!-- Hidden file input -->
      <input type="file" id="file-input" name="files" class="hidden" multiple />
    </form>

    <!-- Attachment preview (muncul saat ada file) -->
    <div id="attachment-preview" class="attachment-preview hidden" aria-live="polite"></div>
  </footer>
</section>
{% endblock %}

{% block scripts %}
{{ super() }}
{% endblock %}