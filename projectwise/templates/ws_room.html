{% extends 'base.html' %}
{% block title %}War Room • ProjectWise{% endblock %}

{% block head %}
{% endblock %}

{% block body %}
<section class="ws-area">
    <header class="ws__header" aria-label="WS Header">
        <div class="ws__title">
            <i class="fa-solid fa-robot"></i>
            War Room (ProjectWise)
        </div>
        <div class="ws__meta">
            <input type="text" id="ws-room-id" class="ws-input-bar" placeholder="Room ID" autocomplete="off">
            <input type="text" id="ws-user-id" class="ws-input-bar" placeholder="Username" autocomplete="off">
            <label class="status">
                <span class="ws-dot" id="conn-dot" title="Disconnected"></span>
                <span id="conn-label">Disconnected</span>
            </label>
            <label class="small">
                <input type="checkbox" id="ws-auto-reconnect"> Auto-reconnect
            </label>
            <button id="join-room-btn" class="btn btn--primary">Join</button>
            <button id="leave-room-btn" class="btn btn--ghost hidden" disabled>Leave</button>
        </div>
    </header>

    <section id="ws-section" class="ws__messages" aria-live="polite" aria-label="Messages">
        <div id="empty-state" class="empty-state">
            <div class="empty-state__icon">
                <i class="fa-solid fa-sparkles"></i>
            </div>
            <h2 class="empty-state__title">Mulai percakapan</h2>
            <p class="empty-state__desc">
                Enter <b>Room ID</b> & <b>Username</b>, then press <b>Join</b>.
            </p>
        </div>

        <!-- Typing indicator -->
        <div id="typing" class="typing hidden" aria-hidden="true" aria-label="Assistant is typing">
            <span class="dot"></span><span class="dot"></span><span class="dot"></span>
        </div>

        <!-- ws chat messages here -->

    </section>

    <!-- Input bar (horizontal) -->
    <footer class="chat__input main__input" aria-label="Chat Input">
        <form id="ws-form" class="input-bar" autocomplete="off">
            <!-- Tombol “+” + drop-up -->
            <div class="upload-dropdown">
                <button type="button" id="upload-btn" class="btn btn--icon" title="Upload" aria-haspopup="true"
                    aria-expanded="false">
                    <i class="fa-solid fa-plus"></i>
                </button>
                <div id="upload-menu" class="upload-menu hidden" role="menu" aria-label="Upload Menu">
                    <button type="button" data-type="ws-document" class="upload-menu__item" role="menuitem">
                        <i class="fa-regular fa-file-lines"></i> Upload document
                    </button>
                </div>
            </div>

            <!-- Textarea fleksibel -->
            <textarea id="ws-input" name="ws-message" placeholder="Mulai diskusi…" autocomplete="off" required rows="1"
                class="ws-textarea" aria-label="Message input"></textarea>

            <!-- Kirim -->
            <button type="submit" class="btn btn--send" title="Kirim">
                <i class="fa-solid fa-paper-plane"></i>
            </button>

            <!-- Hidden file input -->
            <input type="file" id="file-input" name="files" class="hidden" multiple />
        </form>

        <!-- Attachment preview (muncul saat ada file) -->
        <div id="attachment-preview" class="attachment-preview hidden" aria-live="polite"></div>
    </footer>
</section>
{% endblock %}
